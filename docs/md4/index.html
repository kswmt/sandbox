<!DOCTYPE html>
<html>
<head>
<title>ボタンテスト</title>
<meta name="viewport" content="width=320,user-scalable=no">
<style>
  html, body, div, span, button {
    margin: 0;
    padding: 0;
  }
  header{
    background: rgb(255, 197, 197);
    position: fixed;
    width: 320px;
    height: 30px;
  }
  span {
    display: inline-block;
    text-align: center;
  }
  .rt {
    width: 13px;
    margin-top: 5px;
    font-size: 12px;
  }
  .result {
    width: 34px;
    margin-top: 5px;
    font-size: 12px;
    font-weight: bold;
  }
  .header-back {
    height: 30px;
  }
  .tile {
    width: 320px;
  }
  .title {
    font-size: 16px;
    width: 160px;
  }
  .inc-button {
    width: 40px;
    height: 40px;
    font-size: 30px;
  }
  .dec-button {
    width: 40px;
    height: 40px;
    font-size: 30px;
  }
  .count {
    font-size: 30px;
    width: 50px;
  }
</style>
</head>
<body>
<script>
  var data = [
    ["スイカ MC当選", 0.18, 0.18, 0.25, 0.25, 0.3, 0.3],
    ["スイカ MC非当選", 0.819, 0.819, 0.749, 0.749, 0.699, 0.699],
  ]
  var c = [0, 1, 2]
  function dec(i) {
    c[i]--
    update()
  }
  function inc(i) {
    c[i]++
    update()
  }
  function update() {
    var elm = document.getElementById("c0")
    elm.textContent = c[0]
    localStorage.setItem('c0', c[0]);
    var elm = document.getElementById("c1")
    elm.textContent = c[1]
    localStorage.setItem('c1', c[1]);

    var p = [1, 1, 1, 1, 1, 1];
    for (i = 0; i < data.length; i++) {
      if (c[i] < 1) continue;
      for (j = 0; j < 6; j++) {
        for (k = 0; k < c[i]; k++) p[j] *= data[i][j+1];
      }
    }
    var sum = 0;
    for (i = 0; i < 6; i++) sum += p[i];
    for (i = 0; i < 6; i++) {
      document.getElementById("r" + (i+1)).textContent = Math.round(p[i]*1000/sum)/10+"%";
    }
  }
  window.onload = function() {
    var area = document.getElementById("area");
    for (i = 0; i < data.length; i++) {
      var tile = document.createElement("div");
      tile.className = "tile";
      var t = document.createElement("span");
      t.id = "t" + i;
      t.className = "title";
      t.textContent = data[i][0];
      var db = document.createElement("button");
      db.id = "db" + i;
      db.className = "dec-button";
      db.onclick = function(e) { dec(e.target.id.slice(2) - 0) };
      db.textContent = "-";
      var ib = document.createElement("button");
      ib.id = "ib" + i;
      ib.className = "inc-button";
      ib.onclick = function(e) { inc(e.target.id.slice(2) - 0) };
      ib.textContent = "+";
      var count = document.createElement("span");
      count.id = "c" + i;
      count.className = "count";
      tile.appendChild(t);
      tile.appendChild(db);
      tile.appendChild(ib);
      tile.appendChild(count);
      area.appendChild(tile);
    }
    c[0] = localStorage.getItem('c0') || 0;
    c[1] = localStorage.getItem('c1') || 0;
    update()
  }
</script>
<header>
  <span class="rt">1:</span><span id="r1" class="result">10%</span>
  <span class="rt">2:</span><span id="r2" class="result">10%</span>
  <span class="rt">3:</span><span id="r3" class="result">10%</span>
  <span class="rt">4:</span><span id="r4" class="result">10%</span>
  <span class="rt">5:</span><span id="r5" class="result">10%</span>
  <span class="rt">6:</span><span id="r6" class="result">10%</span>
</header>
<div class="header-back"></div>
<div id="area">
</div>
<h1>あ</h1>
<h1>あ</h1>
<h1>あ</h1>
<h1>あ</h1>
<h1>あ</h1>
<h1>い</h1>
<h1>い</h1>
<h1>い</h1>
<h1>い</h1>
<h1>う</h1>
<h1>う</h1>
<h1>う</h1>
<h1>う</h1>
<h1>う</h1>
<h1>え</h1>
<h1>え</h1>
<h1>え</h1>
<h1>え</h1>
<h1>え</h1>
<h1>お</h1>
<h1>お</h1>
<h1>お</h1>
<h1>お</h1>
<h1>お</h1>
</body>
</html>